// === КАЛЬКУЛЯТОР ===

// Сохраненные конфигурации продуктов
model ProductConfiguration {
  id          String @id @default(cuid())
  name        String // Название конфигурации
  productId   String
  totalPrice  Float
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  product     Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  materials   ConfigurationMaterial[]
  workTypes   ConfigurationWorkType[]
  funds       ConfigurationFund[]

  @@map("product_configurations")
}

// Материалы в конфигурации
model ConfigurationMaterial {
  id              String @id @default(cuid())
  configurationId String
  materialId      String
  quantity        Float
  price           Float
  createdAt       DateTime @default(now())

  // Relations
  configuration   ProductConfiguration @relation(fields: [configurationId], references: [id], onDelete: Cascade)
  material       MaterialItem @relation(fields: [materialId], references: [id], onDelete: Cascade)

  @@map("configuration_materials")
}

// Работы в конфигурации
model ConfigurationWorkType {
  id              String @id @default(cuid())
  configurationId String
  workTypeId      String
  quantity        Float
  price           Float
  createdAt       DateTime @default(now())

  // Relations
  configuration   ProductConfiguration @relation(fields: [configurationId], references: [id], onDelete: Cascade)
  workType       WorkType @relation(fields: [workTypeId], references: [id], onDelete: Cascade)

  @@map("configuration_work_types")
}

// Фонды в конфигурации
model ConfigurationFund {
  id              String @id @default(cuid())
  configurationId String
  fundId          String
  percentage      Float
  createdAt       DateTime @default(now())

  // Relations
  configuration   ProductConfiguration @relation(fields: [configurationId], references: [id], onDelete: Cascade)
  fund           Fund @relation(fields: [fundId], references: [id], onDelete: Cascade)

  @@map("configuration_funds")
}
